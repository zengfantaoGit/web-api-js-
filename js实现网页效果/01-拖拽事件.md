# 使用原生js实现拖拽效果

此次实验中只会使用mousedown,mouseup,mouseover等事件来实现简易的拖拽效果。 
***
## (1). click事件与mouseup,mousedown区别

首先用户想要完成拖拽这一操作，它的动作里肯定包含了鼠标按下的这个动作。 
在这里比较容易和 click 事件搞混。首先我们要知道 click 事件是包含两个动作的。  
一个是用户鼠标按下，一个是用户鼠标抬起。这两个关键动作如果在一起则构成了我们的 click 事件。

> “click 事件会在 mousedown 和 mouseup 事件依次触发后触发。”

***
## (2) clientX 属性

clientX可以被简单认为是从点击坐标点到视图最左侧之间的距离。  
即是以浏览器窗口左上角为坐标原点的x坐标。  
通过vue实例的data属性进行存放

```js
data: {
      return {
        isClick: false,
        boxDom: undefined,
        leftX: 0
      }
    }
```

同时不需要每次鼠标移动时就触发mousemove事件，只有当被点击时才触发。   
此时可以维护一个变量`isClick`来判断当前是否处于点击态。  

但由于拖动时候会离开当前的盒子范围，使得松开鼠标也无法触发绑定在盒子上的
mouseup事件，此时需要使用事件代理，在父盒子上绑定mouseup事件，由于事件代理。
父盒子也会触发mouseup事件。

具体代码如下：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
  <style>
    .container {
      position: relative;
      margin: 300px auto;
      height: 200px;
      border: 1px solid black;
    }
    .box {
      position: absolute;
      left: 0;
      display: inline-block;
      height: 100%;
      width: 200px;
      background: yellow;
    }
  </style>
</head>

<body>
<div class="container" @mouseup="mouseUp">
  <div class="box"
       @mousedown="mouseDown"
       @mousemove="mouseMove"
  ></div>
  {{isClick}}
</div>
</body>
<script src="../js/vue.js"></script>
<script>
  const box = document.querySelector('.box');
  const vm = new Vue({
    el: '.container',
    data() {
      return {
        isClick: false,
        boxDom: undefined,
        leftX: 0
      }
    },
    mounted() {
      this.boxDom = document.querySelector('.box')
    },
    methods: {
      mouseDown(event) {
        this.isClick = true
        let {left} = window.getComputedStyle(this.boxDom);
        this.leftX = event.clientX - parseInt(left)
      },
      mouseUp(event) {
        this.isClick = false
      },
      mouseMove(event) {
        if (this.isClick) {
          this.boxDom.style.left = `${event.clientX - this.leftX}px`
        }
      }
    }
  })

</script>
</html>
```


